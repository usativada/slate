
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Analytics Implementation Guide</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#prerequisites" class="toc-h1 toc-link" data-title="Prerequisites">Prerequisites</a>
          </li>
          <li>
            <a href="#ensighten-implementation" class="toc-h1 toc-link" data-title="Ensighten Implementation">Ensighten Implementation</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#1-create-a-new-space" class="toc-h2 toc-link" data-title="1. Create a new space">1. Create a new space</a>
                  </li>
                  <li>
                    <a href="#2-update-namespace" class="toc-h2 toc-link" data-title="2. Update Namespace">2. Update Namespace</a>
                  </li>
                  <li>
                    <a href="#3-add-to-global-template" class="toc-h2 toc-link" data-title="3. Add To Global Template">3. Add To Global Template</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#site-implementation" class="toc-h1 toc-link" data-title="Site Implementation">Site Implementation</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#initialization" class="toc-h2 toc-link" data-title="Initialization">Initialization</a>
                  </li>
                  <li>
                    <a href="#page-view-tracking" class="toc-h2 toc-link" data-title="Page View Tracking">Page View Tracking</a>
                  </li>
                  <li>
                    <a href="#interaction-tracking" class="toc-h2 toc-link" data-title="Interaction Tracking">Interaction Tracking</a>
                  </li>
                  <li>
                    <a href="#video-tracking" class="toc-h2 toc-link" data-title="Video Tracking">Video Tracking</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#testing-analytics-calls" class="toc-h1 toc-link" data-title="Testing Analytics Calls">Testing Analytics Calls</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#page-view-call" class="toc-h2 toc-link" data-title="Page View Call">Page View Call</a>
                  </li>
                  <li>
                    <a href="#interaction-call" class="toc-h2 toc-link" data-title="Interaction Call">Interaction Call</a>
                  </li>
                  <li>
                    <a href="#video-start-or-ad-start-call" class="toc-h2 toc-link" data-title="Video Start or Ad Start Call">Video Start or Ad Start Call</a>
                  </li>
                  <li>
                    <a href="#video-heartbeat-call" class="toc-h2 toc-link" data-title="Video Heartbeat Call">Video Heartbeat Call</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#helpful-docs" class="toc-h1 toc-link" data-title="Helpful Docs">Helpful Docs</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#commit-vs-publish" class="toc-h2 toc-link" data-title="Commit vs Publish">Commit vs Publish</a>
                  </li>
                  <li>
                    <a href="#ensighten-training" class="toc-h2 toc-link" data-title="Ensighten Training">Ensighten Training</a>
                  </li>
                  <li>
                    <a href="#dev-contact" class="toc-h2 toc-link" data-title="Dev Contact">Dev Contact</a>
                  </li>
              </ul>
          </li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='prerequisites'>Prerequisites</h1>
<ul>
<li>Analytics VVM or User Story</li>
<li>Access to Ensighten</li>
<li>Adobe configuration values :

<ul>
<li>Report Suite ID (rsid) = provided in VVM or User Story</li>
<li>Adobe Login Company = &quot;Turner&quot;</li>
<li>Secure Tracking Server = &quot;sanalytics.tbs.com or sanalytics.tntdrama.com or sanalytics.trutv.com&quot;</li>
<li>Non-Secure Tracking Server = &quot;analytics.tbs.com or analytics.tntdrama.com or analytics.trutv.com&quot;</li>
<li>Namespace = &quot;turnerclassicmovies&quot;</li>
</ul></li>
</ul>
<h1 id='ensighten-implementation'>Ensighten Implementation</h1><h2 id='1-create-a-new-space'>1. Create a new space</h2>
<blockquote>
<p>Example Bootstrap:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"text/javascript"</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"//nexus.ensighten.com/turner/example-space/Bootstrap.js"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"text/javascript"</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"//agility.tbs.com/turner/tbs-prod/Bootstrap.js"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre>
<ol>
<li>Log in to Ensighten Manage.</li>
<li>Click <strong>Spaces</strong> from left menu.</li>
<li>Click <strong>Add Space</strong> and enter your space info.</li>
<li>Publish your changes and make a note of the Bootstrap include script.</li>
</ol>

<aside class="success">
  <strong>Best Practices for creating a new space</strong>
  <ul>
    <li>Create a space per environment: <strong>production</strong> and <strong>non-production</strong> environments.</li>
    <li>Add a server side <strong>kill switch</strong> for the Bootstrap. In case of the Ensighten causing any issues on the site, you can easily take it out.</li>
    <li>Add an <strong>environment logic</strong> to automatically load production vs non-production Bootstrap.</li>
    <li>Enable <strong>Tag Alerts</strong> and <strong>Publish Alerts</strong> (Click <strong>turnerintl</strong> in the top right and select <strong>settings</strong>), so you get a notification email when someone publishes in your space.</li>
  </ul>
</aside>
<h2 id='2-update-namespace'>2. Update Namespace</h2>
<p>Update the Namespace of the newly created Space, so it does not conflict with another Bootstrap on a page.</p>

<ol>
<li>Log in to Ensighten Manage.</li>
<li>Click <strong>Publish Paths</strong> from left menu.</li>
<li>Edit the Publish Path of the newly created Space.</li>
<li>Change the Namespace from &quot;Bootstrapper&quot; to &quot;tdi&quot;.</li>
<li>Save changes.</li>
</ol>

<p><img src="images/images/update-namespace.png" alt="alt text" /></p>
<h2 id='3-add-to-global-template'>3. Add To Global Template</h2>
<p>Add the newly created Space to the latest global template.</p>

<ol>
<li>Click <strong>Spaces</strong> from left menu.</li>
<li>Edit the latest global template Space.</li>
<li>Add your space.</li>
<li>Save changes.</li>
</ol>

<p><img src="images/images/addto-globaltemplate.png" alt="alt text" /></p>

<ol>
<li>Create a new Custom JavaScript called <strong>&quot;Site Configuration&quot;</strong> 
<span style="color:red">(Do not merge from other Configuration tag. If you do, it will inherit the settings and you will not be able to perform the next steps.)</span>.</li>
<li>Copy the <strong>Configuration</strong> code from the global template and add to the <strong>Site Configuration</strong> tag.</li>
<li>Update the configuration to appropriate values.</li>
<li>Choose <strong>Synchronous</strong> condition.</li>
<li>Choose the <strong>Configuration</strong> code from the global template to fire first.</li>
<li>Save changes.</li>
</ol>

<p><img src="images/images/site-configuration-tag.png" alt="alt text" /></p>
<h1 id='site-implementation'>Site Implementation</h1><h2 id='initialization'>Initialization</h2>
<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">head</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
          <span class="kd">var</span> <span class="nx">turner_metadata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"content_type"</span><span class="p">:</span> <span class="s2">"adbp:none"</span><span class="p">,</span>
    <span class="s2">"friendly_page_name"</span><span class="p">:</span> <span class="s2">"miracle workers: dark ages"</span><span class="p">,</span>
    <span class="s2">"mvpd"</span><span class="p">:</span> <span class="s2">"no value"</span><span class="p">,</span>
    <span class="s2">"series_name"</span><span class="p">:</span> <span class="s2">"miracle workers: dark ages"</span><span class="p">,</span>
    <span class="s2">"template_type"</span><span class="p">:</span> <span class="s2">"adbp:content"</span><span class="p">,</span>
    <span class="s2">"app_name"</span><span class="p">:</span> <span class="s2">"tbs|us|english"</span><span class="p">,</span>
    <span class="s2">"device"</span><span class="p">:</span> <span class="s2">"web"</span><span class="p">,</span>
    <span class="s2">"device_type"</span><span class="p">:</span> <span class="s2">"web"</span><span class="p">,</span>
    <span class="s2">"episode_num"</span><span class="p">:</span> <span class="s2">"1"</span><span class="p">,</span>
    <span class="s2">"mvpd_status"</span><span class="p">:</span> <span class="s2">"no value"</span><span class="p">,</span>
    <span class="s2">"network"</span><span class="p">:</span> <span class="s2">"tbs"</span><span class="p">,</span>
    <span class="s2">"season_num"</span><span class="p">:</span> <span class="s2">"2"</span><span class="p">,</span>
    <span class="s2">"user_id"</span><span class="p">:</span> <span class="s2">"no value"</span><span class="p">,</span>
    <span class="s2">"app_webview"</span><span class="p">:</span> <span class="s2">"false"</span><span class="p">,</span>
    <span class="s2">"content_labels"</span><span class="p">:</span> <span class="s2">"no value"</span><span class="p">,</span>
    <span class="s2">"section"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"episode info"</span><span class="p">,</span> <span class="s2">"miracle workers: dark ages"</span><span class="p">]</span>
<span class="p">};</span>
      <span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"//nexus.ensighten.com/turner/example-space/Bootstrap.js"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>      <span class="nx">example</span> <span class="nx">of</span> <span class="nx">tbs</span> <span class="p">:</span> <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"text/javascript"</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"//agility.tbs.com/turner/tbs-prod/Bootstrap.js"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="sr">/head</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/html</span><span class="err">&gt;
</span></code></pre>
<p>A global standards implementation starts with two steps. In the <code>&lt;head&gt;</code> of every page:</p>

<ol>
<li>Add a JavaScript Object named <strong>turner_metadata</strong> with an empty <strong>trackAction</strong> array.</li>
<li>Add a call to an external JavaScript file; the Ensighten <strong>Bootstrap.js</strong>.</li>
</ol>

<aside class="success">
  <strong>Turner Metadata Object</strong>
  <br><br>
  In the context of HTML based content (e.g., web sites), the <strong><i>turner_metadata</i></strong> object is:
  <ul>
    <li>A window-scoped variable</li>
    <li>Defined as turner_metadata</li>
    <li>Follows JSON Syntax</li>
    <li>Must contain <i>trackAction</i> array</li>
  </ul>
</aside>

<aside class="notice">
  <strong>OneTrust Banner</strong>
  <br><br>
  OneTrust banner script should be implemented by the site dev team. <i style="color:red;">Analytics team does not provide the script.</i>
  <br>
  Once the OneTrust banner has implemented, <strong><i>OnetrustActiveGroups</i></strong> variable should be created, and it must contain at least one of the following category IDs:
  <ul>
    <li>Category 1 - Strictly Necessary</li>
    <li>Category 2 - Performance</li>
    <li>Category 3 - Functional</li>
    <li>Category 4 - Targeting</li>
    <li>Category 8 - Social Media</li>
  </ul>
  <strong>Best Practices:</strong>
  <ul>
    <li>Implement the black veil overlay, so the users cannot navigate into the site until they agree to the user consent.</li>
    <li>Reload the page once the users agree to the user consent, so you can capture the initial pageview.</li>
  </ul>
</aside>
<h2 id='page-view-tracking'>Page View Tracking</h2>
<blockquote>
<p>Example Page View Tracking</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code> <span class="kd">var</span> <span class="nx">turner_metadata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"content_type"</span>      <span class="p">:</span> <span class="s2">"other:static"</span><span class="p">,</span>
        <span class="s2">"friendly_page_name"</span><span class="p">:</span> <span class="s2">"home page"</span><span class="p">,</span>
        <span class="s2">"mvpd"</span>              <span class="p">:</span> <span class="s2">"no value"</span><span class="p">,</span>
        <span class="s2">"template_type"</span>     <span class="p">:</span> <span class="s2">"adbp:index"</span><span class="p">,</span>
        <span class="s2">"app_name"</span>          <span class="p">:</span> <span class="s2">"tbs|us|english"</span><span class="p">,</span>
        <span class="s2">"device"</span>            <span class="p">:</span> <span class="s2">"web"</span><span class="p">,</span>
        <span class="s2">"device_type"</span>       <span class="p">:</span> <span class="s2">"web"</span><span class="p">,</span>
        <span class="s2">"episode_num"</span>       <span class="p">:</span> <span class="s2">"no value"</span><span class="p">,</span>
        <span class="s2">"mvpd_status"</span>       <span class="p">:</span> <span class="s2">"no value"</span><span class="p">,</span>
        <span class="s2">"network"</span>           <span class="p">:</span> <span class="s2">"tbs | tnt | tru"</span><span class="p">,</span>
        <span class="s2">"season_num"</span>        <span class="p">:</span> <span class="s2">"no value"</span><span class="p">,</span>
        <span class="s2">"user_id"</span>           <span class="p">:</span> <span class="s2">"no value"</span><span class="p">,</span>
        <span class="s2">"app_webview"</span>       <span class="p">:</span> <span class="s2">"false"</span><span class="p">,</span>
        <span class="s2">"section"</span>           <span class="p">:</span> <span class="p">[</span><span class="s2">"home"</span><span class="p">,</span> <span class="s2">"main"</span><span class="p">]</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="nx">trackMetrics</span><span class="p">({</span>
                <span class="na">type</span><span class="p">:</span> <span class="s2">"pageview"</span><span class="p">,</span>
                <span class="na">data</span><span class="p">:</span> <span class="nx">turner_metadata</span>
            <span class="p">});</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{}</span>
</code></pre>
<p>The example on the right-hand side shows all parameters that can be included with a page view call.</p>

<ul>
<li>Use <strong>trackMetrics</strong> array to push your page view calls.</li>
<li><strong>previouspage</strong> variable is handled through Adobe <em>getPreviousValue</em> plugin and does not need to be set.</li>
</ul>

<aside class="success">
  <strong>TrackMetrics Array</strong>
  <br><br>
  <p>The <i>trackMetrics</i> array is used for all tracking.  Tracked events may be pushed into the <i>trackMetrics</i> array before Ensighten Bootstrap is loaded.</p>
</aside>
<h2 id='interaction-tracking'>Interaction Tracking</h2>
<blockquote>
<p>Featured Content Click</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackMetrics</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"interaction"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">"interaction"</span> <span class="p">:</span> <span class="s2">"featured content event"</span><span class="p">,</span>
    <span class="s2">"featuredcontent"</span> <span class="p">:</span> <span class="s2">"featured content name"</span><span class="p">,</span>
    <span class="s2">"featuredcontentevent"</span> <span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Interaction and Social Click</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackMetrics</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"interaction"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">"interaction"</span> <span class="p">:</span> <span class="s2">"name of social or button"</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Registration Process Start Click</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackMetrics</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"interaction"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">"interaction"</span> <span class="p">:</span> <span class="s2">"registration start event"</span>
  <span class="p">}</span>
<span class="p">});</span>

</code></pre>
<blockquote>
<p>Successful Registration Complete</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackMetrics</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"interaction"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">"interaction"</span> <span class="p">:</span> <span class="s2">"registration complete event"</span><span class="p">,</span>
    <span class="s2">"registrationevent"</span> <span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Internal Campaign/Banner Click</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackMetrics</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"interaction"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">"interaction"</span> <span class="p">:</span> <span class="s2">"internal campaign event"</span><span class="p">,</span>
    <span class="s2">"internalcampaign"</span> <span class="p">:</span> <span class="s2">"campaign name"</span><span class="p">,</span>
    <span class="s2">"featuredcontentevent"</span> <span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Login Click</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackMetrics</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"interaction"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">"interaction"</span> <span class="p">:</span> <span class="s2">"login start event"</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Successful Login Complete</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackMetrics</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"interaction"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">"interaction"</span> <span class="p">:</span> <span class="s2">"login complete event"</span><span class="p">,</span>
    <span class="s2">"loginevent"</span> <span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<p>The examples on the right-hand side list all global standard interaction calls.</p>

<p>The examples on the right-hand side list the standard game tracking calls.</p>

<ul>
<li>The <strong>gamersid</strong> variable will send your call to a different Adobe report suite on fly. Omitting the variable will direct the traffic to the default report suite(s).</li>
</ul>

<aside class="success">
  <strong>iFrame Games</strong>
  <br><br>
  If your game is hosted in an iframe, you must add the following Ensighten Bootstrap on your iframe page <code>&lt;head&gt;</code> before adding any tracking calls.
  <br>
  <code style="display:block; white-space:pre-wrap;">
    &lt;script&gt;
      var turner_metadata = {
          "trackAction" : []
      };
    &lt;/script&gt;
    &lt;script src="//nexus.ensighten.com/turnerintl/&lt;example-space&gt;/Bootstrap.js"&gt;&lt;/script&gt;
  </code>
  <i>** The correct Bootstrap.js file will be provided by the analytics team.</i>
  <br><br>
  Also, to include the page level data, you must ask the site dev team to add the page metadata to your iframe source query string.
  <br>
  <code style="display:block; white-space:pre-wrap;">
    &lt;iframe src="https://emea.iframed.cn.dmti.cloud/game/ben-10-omnicode/index.html?pageName=/cn/ben-10-omnicode&cid=123&OnetrustActiveGroups=1,2"&gt;&lt;/iframe&gt;
  </code>
  <br>
  Common Page Metadata:
  <ul>
    <li>pageName - page name of the parent page (e.g. /uk/cn/ben-10-omnicode)</li>
    <li>cid - campaign code (e.g. 123)</li>
    <li>OnetrustActiveGroups - OneTrust banner variable (e.g. 1,2,3,4)</li>
  </ul>
</aside>
<h2 id='video-tracking'>Video Tracking</h2>
<blockquote>
<p>Player Ready (must be called for every new video including replay)</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="s2">"subtype"</span> <span class="p">:</span> <span class="s2">"Player_Ready"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">"playerid"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* unique player id if multiple instances on a page */</span>
    <span class="s2">"content_duration"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="cm">/* video length in seconds */</span>
    <span class="s2">"content_dataCreated"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* YYYY-MM-DD (e.g. 2018-08-30) */</span>
    <span class="s2">"content_dataAired"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* YYYY-MM-DD (e.g. 2018-08-30) */</span>
    <span class="s2">"content_name"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* video title */</span>
    <span class="s2">"content_id"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* video id */</span>
    <span class="s2">"content_type"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* clip, vod, live */</span>
    <span class="s2">"content_showName"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* show name */</span>
    <span class="s2">"content_seasonNumber"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* season number (e.g. 1, 2, 3, etc.) */</span>
    <span class="s2">"content_episodeNumber"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* episode number (e.g. 1, 2, 3, etc.) */</span>
    <span class="s2">"content_genre"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* genre (e.g. drama, comedy, etc.) */</span>
    <span class="s2">"content_rating"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* rating (e.g. tvy, tvg, tvpg, tvm, etc.) */</span>
    <span class="s2">"content_originator"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* originator (e.g. warnermedia, sony, disney, etc.) */</span>
    <span class="s2">"content_network"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* network (e.g. fox, brabo, espn, etc.) */</span>
    <span class="s2">"content_mvpd"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* mvpd (e.g. comcast, directv, dish, etc.) */</span>
    <span class="s2">"content_authorized"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* true or false */</span>
    <span class="s2">"day_part"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* time of day (e.g. morning, daytime, primetime, etc.) */</span>
    <span class="s2">"content_feed"</span><span class="p">:</span> <span class="s2">""</span> <span class="cm">/* feed (e.g. east-hd, west-hd, east-sd, etc.) */</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Ad Start</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="s2">"subtype"</span> <span class="p">:</span> <span class="s2">"Ad_Started"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">"ad_id"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* ad identifier */</span>
    <span class="s2">"ad_duration"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="cm">/* ad duration in seconds */</span>
    <span class="s2">"ad_type"</span><span class="p">:</span> <span class="s2">""</span> <span class="cm">/* ad type (e.g. preroll, midroll, postroll) */</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Ad Skipped</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="s2">"subtype"</span> <span class="p">:</span> <span class="s2">"Ad_Skipped"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Ad Completes</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="s2">"subtype"</span> <span class="p">:</span> <span class="s2">"Ad_Finished"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Media Start</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="s2">"subtype"</span> <span class="p">:</span> <span class="s2">"Media_Started"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Chapter Starts (Media Start must be called first)</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="na">type</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="na">subtype</span> <span class="p">:</span> <span class="s2">"Media_Chapter_Started"</span><span class="p">,</span>
  <span class="na">data</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">"chapter_name"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="cm">/* chapter name */</span>
    <span class="s2">"chapter_position"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="cm">/* chapter position integer */</span>
    <span class="s2">"chapter_duration"</span><span class="p">:</span> <span class="mi">0</span> <span class="cm">/* chapter duration in seconds */</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Chapter End</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="na">type</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="na">subtype</span> <span class="p">:</span> <span class="s2">"Media_Chapter_Finished"</span><span class="p">,</span>
  <span class="na">data</span> <span class="p">:</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Media Buffering Start</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="s2">"subtype"</span> <span class="p">:</span> <span class="s2">"Media_Buffering_Started"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Media Buffering End</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="s2">"subtype"</span> <span class="p">:</span> <span class="s2">"Media_Buffering_Finished"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Media Pause</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="s2">"subtype"</span> <span class="p">:</span> <span class="s2">"Media_Paused"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Media Resume</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">twindow</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="s2">"subtype"</span> <span class="p">:</span> <span class="s2">"Media_Resumed"</span><span class="p">,</span>
  <span class="s2">"data"</span> <span class="p">:</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Media Finished</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="na">type</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="na">subtype</span> <span class="p">:</span> <span class="s2">"Media_Finished"</span><span class="p">,</span>
  <span class="na">data</span> <span class="p">:</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Content Completed and Unloaded (trigger after post roll)</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">trackTOPEvent</span><span class="p">({</span>
  <span class="na">type</span> <span class="p">:</span> <span class="s2">"video"</span><span class="p">,</span>
  <span class="na">subtype</span> <span class="p">:</span> <span class="s2">"Content_Completed"</span><span class="p">,</span>
  <span class="na">data</span> <span class="p">:</span> <span class="p">{}</span>
<span class="p">});</span>
</code></pre>
<p>The sample code listed on the right-hand side is all possible video calls.</p>

<ul>
<li>Use <i>trackAction</i> array to push your video calls.</li>
<li>The <strong>Player_Ready</strong> call must be called for every new video including <strong>replay</strong>.</li>
<li>The <strong>content_duration</strong> and <strong>ad_duration</strong> variables are in second and must contain only <strong>integer</strong> values.</li>
<li>The <strong>playhead</strong> value should be passed to Ensighten using <code>window.turner_metadata.currentTime = 1;</code>. The <em>currentTime</em> variable should be an <strong>integer</strong> value and should display the current playhead position in second.  It should be updated continuously during the playback, so it always has the current playhead value. At the end of the video, the <em>currentTime</em> value must match the <em>content_duration</em> value.</li>
</ul>

<aside class="success">
  <strong>Recommended Order of Video Events</strong>
  <br><br>
  This scenario assumes you have a pre-roll and a post-roll.
  <ol type="1">
    <li>Player_Ready</li>
    <li>Ad_Started</li>
    <li>Ad_Skipped / Ad_Finished</li>
    <li>Media_Started</li>
    <li>Media_Finished</li>
    <li>Ad_Started</li>
    <li>Ad_Skipped / Ad_Finished</li>
    <li>Content_Completed</li>
  </ul>
</aside>
<h1 id='testing-analytics-calls'>Testing Analytics Calls</h1>
<p>The global template has a debugging mode to see all trackAction calls and the data in your browser dev console.</p>

<ol>
<li>Open your browser dev console</li>
<li>Run <code>localStorage.debugActionTracker = &quot;true&quot;</code></li>
<li>Reload the page to activate the debugging mode</li>
<li>All trackAction calls will display in the dev console</li>
</ol>

<p><strong>You can also see Adobe Analytics call using network sniffing tools, such as Charles Proxy. The following section shows different types of calls and where to look.</strong></p>
<h2 id='page-view-call'>Page View Call</h2>
<p>Every page load should fire a page view call.  A page view call uses analytics tracking server (turnerinternational.sc.omtrdc.net), and you should always check for the correct report suite ID (<strong>RSID</strong>) and existence of a <strong>pageName</strong> variable.</p>

<aside class="warning">
  <b>pageName</b> variable should be outside of c. and .c parameters.
</aside>

<p><img src="images/images/pageview-call-web.png" alt="alt text" /></p>
<h2 id='interaction-call'>Interaction Call</h2>
<p>The main difference between a page view call and an interaction call is <strong>pev2</strong> variable.  The <strong>pev2</strong> variable is only displaying on interaction calls.</p>

<p><img src="images/images/interaction-call-web.png" alt="alt text" /></p>
<h2 id='video-start-or-ad-start-call'>Video Start or Ad Start Call</h2>
<p>On every video and ad start, we are expecting a call to analytics tracking server (turnerinternational.sc.omtrdc.net).  The VHL calls to analytics server display <strong>pe</strong> and <strong>pev3</strong> variables.  The <strong>pe</strong> variable display <strong>ms_s</strong> for content start and <strong>msa_s</strong> for ad start.</p>

<p><img src="images/images/video-start-call-web.png" alt="alt text" /></p>
<h2 id='video-heartbeat-call'>Video Heartbeat Call</h2>
<p>Video heartbeat call uses heartbeat tracking server (turnerinternational.hb.omtrdc.net) and normally fires every 10 seconds while you are watching a video.  Because the content/ad start calls to analytics server already contain all standard and context data, you <strong>do not</strong> need to re-check those data in heartbeat calls.  However, there are few variables you should check.</p>

<ul>
<li><strong>s:event:type</strong> - event type should follows <a href="https://marketing.adobe.com/resources/help/en_US/sc/appmeasurement/hbvideo/vod-preroll-ads.html" target="_blank">the Adobe document</a>.</li>
<li><strong>s:event:sid</strong> - session ID should stay the same while watching the same video, but replay should generate a new session ID.</li>
<li><strong>l:asset:length</strong> - content/ad length should display the correct value in second.</li>
<li><strong>l:event:playhead</strong> - playhead value should advance while watching a content.  It will be zero during ads.</li>
</ul>

<p><img src="images/images/video-heartbeat-call-web.png" alt="alt text" /></p>
<h1 id='helpful-docs'>Helpful Docs</h1><h2 id='commit-vs-publish'>Commit vs Publish</h2>
<blockquote>
<p>Committed Bootstrap:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="c1">//nexus-test.ensighten.com/turnerintl/example-space/Bootstrap.js</span>
</code></pre>
<blockquote>
<p>Published Bootstrap:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="c1">//nexus.ensighten.com/turnerintl/example-space/Bootstrap.js</span>
</code></pre>
<p>Ensighten offers two different Bootstrap.js domains depending on the status of your tag.</p>

<ul>
<li>When a tag is <strong>committed</strong> it is moved to <strong>nexus-test.ensighten.com</strong> domain.</li>
<li>When a tag is <strong>published</strong> it is moved to <strong>nexus.ensighten.com</strong> domain.</li>
</ul>

<p>This is helpful for testing. After merging all changes to the production space within Ensighten; commit the tags and use the nexus-test.ensighten.com domain to verify the changes before publishing. Typically, this is done via a local proxy, such as Charles Proxy or using the Ensighten Browser Extension.</p></p>
<h2 id='ensighten-training'>Ensighten Training</h2>
<p>It is recommended to go through training videos before using Ensighten.</p>

<ul>
<li>Ensighten Training Videos: <a href='https://www.ensighten.com/training/manage-technical/'>https://www.ensighten.com/training/manage-technical/</a></li></li>
<li>Ensighten Adobe Training Videos: <a href='https://www.ensighten.com/training/sitecatalyst-implementation-via-manage/'>https://www.ensighten.com/training/sitecatalyst-implementation-via-manage/</a></li></li>
<li>Ensighten Recommended Tools: <a href='https://www.ensighten.com/training/tools/'> https://www.ensighten.com/training/tools/</a></li></li>
</ul>
<h2 id='dev-contact'>Dev Contact</h2>
<p>Any questions – contact <a href="mainto:adaqdev@turner.com">adaqdev@turner.com</a></li> </p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
